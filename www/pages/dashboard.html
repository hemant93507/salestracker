<template>
  <div class="page">
    <div class="navbar navbar-main bg-color-white color-green">
      <div class="navbar-inner sliding">
        <div class="left">
          <a href="#" class="link icon-only panel-open" data-panel="left">
            <i class="icon material-icons">menu</i>
          </a>
        </div>
        <div class="title">Dashboard</div>
        <div class="right">
          <a href="#" data-popover=".dashboard-popover" class="popover-open link icon-only">
            <i class="icon material-icons">more_vert</i>
          </a>
        </div>
      </div>
    </div>
    <div class="popover dashboard-popover">
      <div class="popover-inner">
        <div class="list">
          <ul>
            <li><a class="color-black list-button item-link popover-close" href="#" onclick="shareApp()">Share App</a>
            </li>
            <li><a @click="logout" class="color-black list-button item-link popover-close" href="#">Logout</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="page-content">
      <div class="block">
        <div class="row">
          <div class="col text-align-center">
            <!-- <div class="gauge gauge-init" data-type="circle" data-value="{{AttendancePercentage/100}}"
              data-value-text="{{AttendancePercentage}}%" data-value-text-color="#4caf50" data-value-font-size="36"
              data-value-font-weight="700" data-border-width="20" data-label-text="Attendance Today"
              data-border-color="#4caf50" data-border-bg-color="#ffeb3b" data-bg-color="#ffffff">
            </div> -->
            <div class="gauge"></div>
          </div>
          <div class="col text-align-center">
            <div class="list no-hairlines">
              <ul>
                <li>
                  <a href="#" class="item-link item-content">
                    <div class="item-inner">
                      <div class="item-title">Present</div>
                      <div class="item-after">{{Present}}</div>
                    </div>
                  </a>
                </li>
                <li>
                  <a href="#" class="item-link item-content">
                    <div class="item-inner">
                      <div class="item-title">Absent</div>
                      <div class="item-after">{{Absent}}</div>
                    </div>
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="block-title font-16" style="padding-left:8px">Attendance Today</div>
      <div class="data-table">
        <table>
          <thead>
            <tr>
              <th class="label-cell color-green">Employee ID</th>
              <th class="label-cell color-green">Employee Name</th>
              <th class="label-cell color-green">Check-In</th>
              <th class="label-cell color-green">Check-Out</th>
            </tr>
          </thead>
          <tbody>
            {{#if Present}}
            {{#each PresentClientList}}
              <tr>
                <!-- <td class="label-cell"><a href="/employee-detail/{{email}}/" class="link">{{user_id}}</a></td> -->
                <!-- <td class="label-cell"><a href="#" class="link">{{user_id}}</a></td> -->
                <td class="label-cell">{{user_id}}</td>
                <td class="label-cell">{{name}}</td>
                <td class="label-cell">{{check_in}}</td>
                <td class="label-cell">{{check_out}}</td>
              </tr>
            {{/each}}
            {{else}}
              <tr>
                <td colspan="4" class="label-cell">No records found!</td>
              </tr>
            {{/if}}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</template>
<script>
  return {
    on: {
      pageInit: function () {
        // $$('.panel-left .profile-menu a').attr('href','/admin-profile/');
        // $$('.panel-left .profile-menu .item-title').text('My Profile');
        $$('.clientvisit-menu,.attendance-menu').hide();
        $$('.employees-menu').show();
        var self = this;
        var data = JSON.parse(localStorage.User);
        var obj = {
          email: data.User.email,
        };
        app.request({
          url: BaseURL + 'admin-dashboard',
          method: 'POST',
          dataType: 'json',
          data: obj,
          //contentType: 'application/json',
          beforeSend: function (xhr) {
            app.preloader.show();
          },
          success: function (data, status, xhr) {
            console.log(data);
            if (data.ErrorCode == '0') {
              var gauge = app.gauge.create({
                labelText: 'amount of something',
                el: '.gauge',
                value: data.AttendancePercentage/100,
                valueText: data.AttendancePercentage + '%',
                valueTextColor: '#4caf50',
                valueFontSize: '36',
                valueFontWeight: '700',
                borderWidth: '20',
                labelText: 'Attendance Today',
                borderColor: '#4caf50',
                borderBgColor: '#ffeb3b',
                bgColor: '#ffffff',
              });
              self.$setState({
                Absent: data.Absent,
                Present: data.Present,
                AttendancePercentage: data.AttendancePercentage,
                PresentClientList: data.PresentClientList,
              });
            }
          },
          complete: function (xhr, status) {
            app.preloader.hide();
          }
        })
      }
    },
    methods: {
      logout: function () {
        localStorage.removeItem("User");
        app.views.main.router.navigate('/');
      }
    },
  }
</script>